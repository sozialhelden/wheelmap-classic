!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["accessibility.cloud"]=t():e["accessibility.cloud"]=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=7)}([function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function o(e,t){var r=t[e+"Localized"]||e;return(0,U.default)(r).replace(/^Rating /,"")}function s(e){return e===!0?_(d):e===!1?_(y):e}function c(e){var t=Math.floor(5*Math.min(1,Math.max(0,e))),r="★★★★★".slice(5-t);return'<span class="stars">'+r+'</span> <span class="numeric">'+t+"/5</span>"}function l(e){if($.isArray(e))return'<ul class="ac-list">'+e.map(function(e){return"<li>"+l(e)+"</li>"}).join("")+"</ul>";if($.isPlainObject(e)){var t=$.map(e,function(t,r){if(r.match(/Localized/))return"";var n=o(r,e);return $.isArray(t)||$.isPlainObject(t)?"areas"===r&&1===t.length?l(t[0]):"<li class=\"ac-group\"><header class='subtle'>"+n+"</header> "+l(t)+"</li>":r.startsWith("rating")?'<li class="ac-rating">'+n+": "+c(parseFloat(t))+"</li>":'<li class="ac-'+("undefined"==typeof t?"undefined":h(t))+'">'+n+": <span class='value'>"+s(t)+"</span></li>"});return'<ul class="ac-group">'+t.join("")+"</ul>"}return e}function u(e){return e.accessibility&&e.accessibility.accessibleWith&&e.accessibility.accessibleWith.wheelchair}Object.defineProperty(t,"__esModule",{value:!0});var f=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),p=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=a(["Yes"],["Yes"]),y=a(["No"],["No"]),v=a(["Accessible with wheelchair"],["Accessible with wheelchair"]),g=a(["Not accessible with wheelchair"],["Not accessible with wheelchair"]),b=a(["No results."],["No results."]),m=a(["Source"],["Source"]),w=a(["Unknown error."],["Unknown error."]),k=a(["Could not load data"],["Could not load data"]),x=r(6),j=n(x),A=r(5),U=n(A),P=(r(3),r(1)),_=P.t,S=function(){function e(t){i(this,e);var r={apiBaseUrl:"https://www.accessibility.cloud",locale:void 0},n=Object.assign(r,t);if(!n.apiBaseUrl||!n.apiBaseUrl.match(/^https?:\/\//))throw new Error("Please supply a valid API domain.");if(!n.locale||!n.locale.match(/[a-z]{2}(_[A-Z]{2})?/))throw new Error("Please supply a valid locale.");if(!n.token||"string"!=typeof n.token)throw new Error("Please supply a valid app or user token.");this.options=n,"undefined"!=typeof P.setGlobalLocale&&(0,P.setGlobalLocale)(this.getLocale())}return p(e,[{key:"getLocale",value:function(){return this.options.locale}},{key:"getPlacesAround",value:function(e,t){var r={};Object.keys(e).forEach(function(t){r[t]=e[t].toString()});var n=function(){};return $.ajax({dataType:"json",url:this.options.apiBaseUrl+"/place-infos?includeRelated=source&locale="+this.getLocale(),data:r,headers:{Accept:"application/json","X-Token":this.options.token}}).done(t||n).fail(t||n)}},{key:"resultsTemplate",value:function(){return'<ul class="ac-result-list" role="treegrid">\n      {{#places}}\n        <li class="ac-result {{isAccessibleClass}}" role="gridcell" aria-expanded="false">\n          <div class="ac-summary">\n            <img src="'+this.options.apiBaseUrl+'/icons/categories/{{properties.category}}.svg"\n              role="presentation"\n              class="ac-result-icon">\n            <div class="ac-result-distance"><a href=\'{{mapsHref}}\'>{{{formattedDistance}}}</a></div>\n            <div class="ac-result-name" role="heading">{{properties.name}}</div>\n            <div class="ac-result-category">{{humanizedCategory}}</div>\n            {{{infoPageLink}}}\n            <div class="ac-result-accessibility-summary">{{accessibilitySummary}}</div>\n            <div class="ac-result-accessibility-details ac-hidden">{{{formattedAccessibility}}}</div>\n          </div>\n        </li>\n      {{/places}}\n    </ul>'}},{key:"renderPlaces",value:function(e,t,r){if($(e).length){var n=this.getLocale();t&&t.length?($(e).html(j.default.render(this.resultsTemplate(),{places:t,humanizedCategory:function(){return(0,U.default)(this.properties.localizedCategory||this.properties.category)},mapsHref:function(){if(!this.geometry||!this.geometry.coordinates||"Point"!==this.geometry.type)return"#";var e=f(this.geometry.coordinates,2),t=e[0],r=e[1];return"https://www.openstreetmap.org/?mlat="+r+"&mlon="+t+"&zoom=20"},formattedDistance:function(){var e="en"===n||"en_UK"===n||"en_US"===n,t=this.properties.distance,r=Math.round(t),i="m";if(e){var a=62137e-8*t;if(a<.1){var o=1.0936*t;r=Math.round(o),i="yd"}else r=String(.1*Math.round(10*a)).replace(/(\.\d)\d+/,"$1"),i="mi"}return"<span class='ac-result-distance-value'>"+r+"</span> <span class='ac-result-distance-unit'>"+i+"</span>"},formattedAccessibility:function(){return l(this.properties.accessibility)},isAccessibleClass:function(){return u(this.properties)?"is-accessible":""},accessibilitySummary:function(){return _(u(this.properties)?v:g)},infoPageLink:function(){var e=r.sources&&r.sources[this.properties.sourceId],t=e&&(e.shortName||e.name);return this.properties.infoPageUrl&&t?'<a href="'+this.properties.infoPageUrl+'" class="ac-result-link">'+t+"</a>":""}})),$("li.ac-result a").click(function(e){return e.stopPropagation()}),$("li.ac-result").click(function(e){return $(e.target).parent().find(".ac-result-accessibility-details").first().slideToggle()})):$(e).html('<div class="ac-no-results">'+_(b)+"</div>")}}},{key:"renderSourcesAndLicenses",value:function(e,t,r){var n=this,i=Object.keys(t).map(function(e){var i=t[e],a=r[i.licenseId],o=n.options.apiBaseUrl+"/licenses/"+a._id,s=i.originWebsiteURL||n.options.apiBaseUrl+"/sources/"+i._id;return'<a href="'+s+'">'+(i.shortName||i.name)+'</a>\n        (<a href="'+o+'">'+(a.shortName||a.name)+"</a>)"});i.length&&$(e).append('<p class="ac-licenses">'+_(m)+": "+i.join(", ")+"</p>")}},{key:"loadAndRenderPlaces",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e,t){};return this.getPlacesAround(t).done(function(t){r.renderPlaces(e,t.features,t.related),r.renderSourcesAndLicenses(e,t.related.sources,t.related.licenses),n(null,t)}).fail(function(t){var r=_(w);try{r=JSON.parse(t.responseText).error.reason}catch(e){r=t.statusText+"<br>"+t.responseText}$(e).html('<div class="ac-error">'+_(k)+":"+r+"</div>"),n(new Error(r))})}}]),e}();t.default=S},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=new RegExp("^"+e+"_");return Object.keys(l.default).find(function(e){return e.match(t)})}function a(e,t){var r=t.replace(/_[A-Z][A-Z]$/),n=t!==r,a=n?t:i(t),o="en_US",s=l.default[t]||{},c=l.default[r]||{},u=l.default[a]||{},f=l.default[o]||{},p=s[e]||c[e]||u[e]||f[e]||e;return p}function o(e){u=e}function s(e){return a(e,u)}Object.defineProperty(t,"__esModule",{value:!0}),t.setGlobalLocale=o,t.t=s;var c=r(2),l=n(c),u="en_US"},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={de:{},de_DE:{Yes:"Ja",No:"Nein","Accessible with wheelchair":"Rollstuhlgerecht","Not accessible with wheelchair":"Nicht rollstuhlgerecht","No results.":"Keine Ergebnisse.",Source:"Quelle","Unknown error.":"Unbekannter Fehler.","Could not load data":"Konnte Daten nicht laden."},en_US:{}};t.default=r},function(e,t){"use strict";function r(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e&&e.reduce?e.reduce(function(e,t,n){return e+t+(r[n]||"")},""):e}function n(){return function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e&&e.reduce?e.reduce(function(e,t,n){return e+t+(r[n]||"")},""):e}}function i(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e&&e.reduce?e.reduce(function(e,t,n){return e+t+(r[n]||"")},""):e}function a(e){return e}function o(e){return e}Object.defineProperty(t,"__esModule",{value:!0}),t.t=r,t.nt=n,t.msgid=i,t.gettext=a,t.ngettext=o},function(e,t){"use strict";e.exports=function(e,t){if("string"!=typeof e)throw new TypeError("Expected a string");return t="undefined"==typeof t?"_":t,e.replace(/([a-z\d])([A-Z])/g,"$1"+t+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+t+"$2").toLowerCase()}},function(e,t,r){"use strict";var n=r(4);e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e=n(e),e=e.toLowerCase().replace(/[_-]+/g," ").replace(/\s{2,}/g," ").trim(),e=e.charAt(0).toUpperCase()+e.slice(1)}},function(e,t,r){var n,i,a;/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
!function(r,o){"object"==typeof t&&t&&"string"!=typeof t.nodeName?o(t):(i=[t],n=o,a="function"==typeof n?n.apply(t,i):n,!(void 0!==a&&(e.exports=a)))}(this,function(e){function t(e){return"function"==typeof e}function r(e){return y(e)?"array":typeof e}function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function i(e,t){return null!=e&&"object"==typeof e&&t in e}function a(e,t){return v.call(e,t)}function o(e){return!a(g,e)}function s(e){return String(e).replace(/[&<>"'`=\/]/g,function(e){return b[e]})}function c(t,r){function i(){if(g&&!b)for(;v.length;)delete d[v.pop()];else v=[];g=!1,b=!1}function a(e){if("string"==typeof e&&(e=e.split(w,2)),!y(e)||2!==e.length)throw new Error("Invalid tags: "+e);s=new RegExp(n(e[0])+"\\s*"),c=new RegExp("\\s*"+n(e[1])),p=new RegExp("\\s*"+n("}"+e[1]))}if(!t)return[];var s,c,p,h=[],d=[],v=[],g=!1,b=!1;a(r||e.tags);for(var A,U,P,_,S,E,O=new f(t);!O.eos();){if(A=O.pos,P=O.scanUntil(s))for(var $=0,T=P.length;$<T;++$)_=P.charAt($),o(_)?v.push(d.length):b=!0,d.push(["text",_,A,A+1]),A+=1,"\n"===_&&i();if(!O.scan(s))break;if(g=!0,U=O.scan(j)||"name",O.scan(m),"="===U?(P=O.scanUntil(k),O.scan(k),O.scanUntil(c)):"{"===U?(P=O.scanUntil(p),O.scan(x),O.scanUntil(c),U="&"):P=O.scanUntil(c),!O.scan(c))throw new Error("Unclosed tag at "+O.pos);if(S=[U,P,A,O.pos],d.push(S),"#"===U||"^"===U)h.push(S);else if("/"===U){if(E=h.pop(),!E)throw new Error('Unopened section "'+P+'" at '+A);if(E[1]!==P)throw new Error('Unclosed section "'+E[1]+'" at '+A)}else"name"===U||"{"===U||"&"===U?b=!0:"="===U&&a(P)}if(E=h.pop())throw new Error('Unclosed section "'+E[1]+'" at '+O.pos);return u(l(d))}function l(e){for(var t,r,n=[],i=0,a=e.length;i<a;++i)t=e[i],t&&("text"===t[0]&&r&&"text"===r[0]?(r[1]+=t[1],r[3]=t[3]):(n.push(t),r=t));return n}function u(e){for(var t,r,n=[],i=n,a=[],o=0,s=e.length;o<s;++o)switch(t=e[o],t[0]){case"#":case"^":i.push(t),a.push(t),i=t[4]=[];break;case"/":r=a.pop(),r[5]=t[2],i=a.length>0?a[a.length-1][4]:n;break;default:i.push(t)}return n}function f(e){this.string=e,this.tail=e,this.pos=0}function p(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function h(){this.cache={}}var d=Object.prototype.toString,y=Array.isArray||function(e){return"[object Array]"===d.call(e)},v=RegExp.prototype.test,g=/\S/,b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},m=/\s*/,w=/\s+/,k=/\s*=/,x=/\s*\}/,j=/#|\^|\/|>|\{|&|=|!/;f.prototype.eos=function(){return""===this.tail},f.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var r=t[0];return this.tail=this.tail.substring(r.length),this.pos+=r.length,r},f.prototype.scanUntil=function(e){var t,r=this.tail.search(e);switch(r){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=t.length,t},p.prototype.push=function(e){return new p(e,this)},p.prototype.lookup=function(e){var r,n=this.cache;if(n.hasOwnProperty(e))r=n[e];else{for(var a,o,s=this,c=!1;s;){if(e.indexOf(".")>0)for(r=s.view,a=e.split("."),o=0;null!=r&&o<a.length;)o===a.length-1&&(c=i(r,a[o])),r=r[a[o++]];else r=s.view[e],c=i(s.view,e);if(c)break;s=s.parent}n[e]=r}return t(r)&&(r=r.call(this.view)),r},h.prototype.clearCache=function(){this.cache={}},h.prototype.parse=function(e,t){var r=this.cache,n=r[e];return null==n&&(n=r[e]=c(e,t)),n},h.prototype.render=function(e,t,r){var n=this.parse(e),i=t instanceof p?t:new p(t);return this.renderTokens(n,i,r,e)},h.prototype.renderTokens=function(e,t,r,n){for(var i,a,o,s="",c=0,l=e.length;c<l;++c)o=void 0,i=e[c],a=i[0],"#"===a?o=this.renderSection(i,t,r,n):"^"===a?o=this.renderInverted(i,t,r,n):">"===a?o=this.renderPartial(i,t,r,n):"&"===a?o=this.unescapedValue(i,t):"name"===a?o=this.escapedValue(i,t):"text"===a&&(o=this.rawValue(i)),void 0!==o&&(s+=o);return s},h.prototype.renderSection=function(e,r,n,i){function a(e){return o.render(e,r,n)}var o=this,s="",c=r.lookup(e[1]);if(c){if(y(c))for(var l=0,u=c.length;l<u;++l)s+=this.renderTokens(e[4],r.push(c[l]),n,i);else if("object"==typeof c||"string"==typeof c||"number"==typeof c)s+=this.renderTokens(e[4],r.push(c),n,i);else if(t(c)){if("string"!=typeof i)throw new Error("Cannot use higher-order sections without the original template");c=c.call(r.view,i.slice(e[3],e[5]),a),null!=c&&(s+=c)}else s+=this.renderTokens(e[4],r,n,i);return s}},h.prototype.renderInverted=function(e,t,r,n){var i=t.lookup(e[1]);if(!i||y(i)&&0===i.length)return this.renderTokens(e[4],t,r,n)},h.prototype.renderPartial=function(e,r,n){if(n){var i=t(n)?n(e[1]):n[e[1]];return null!=i?this.renderTokens(this.parse(i),r,n,i):void 0}},h.prototype.unescapedValue=function(e,t){var r=t.lookup(e[1]);if(null!=r)return r},h.prototype.escapedValue=function(t,r){var n=r.lookup(t[1]);if(null!=n)return e.escape(n)},h.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="2.3.0",e.tags=["{{","}}"];var A=new h;return e.clearCache=function(){return A.clearCache()},e.parse=function(e,t){return A.parse(e,t)},e.render=function(e,t,n){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+r(e)+'" was given as the first argument for mustache#render(template, view, partials)');return A.render(e,t,n)},e.to_html=function(r,n,i,a){var o=e.render(r,n,i);return t(a)?void a(o):o},e.escape=s,e.Scanner=f,e.Context=p,e.Writer=h,e})},function(e,t,r){e.exports=r(0)}])});
